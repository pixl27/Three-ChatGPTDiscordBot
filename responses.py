from revChatGPT.revChatGPT import AsyncChatbot as Chatbot
import os
import requests
import json
import asyncio

Global_prompt = ""

config = {
    #"Authorization": '<Auth>',
    #"email": "one2king1@gmail.com",
    #"password": "Maherylepro1"
    #"cf_clearance":
    #"B99kAdjKkFXxRWVeO8c.qw_j0wIuw3wCBTPEOVX20UE-1670830927-0-160",
    #"user_agent":
    #"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36",
    #"session_token":
    #"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..qaTxFMPtjOt8eHKb.9DDAhWHRSnRRX5wA7GFrdMV3tDdB_FVCrbyRnLghHxOLJEUobgZe8jSMBL6Dzltkrfs_EhBHG-_sne0xMRhxaEN0ldvCtw1fqc2Igg0qkrtMpSvFc37uOiC6UCGGolY9HaMlAwbd2G1Vmu0lYod3vT1DDnPMooBHZskSZOpB6VteYyLSI1tgLSO_F4i8zkOdmHCs3PmhCUaOLgKsZr3UlrbRHlm9utshSsPzf9SNkb5PMeliokHXAT7jQVcNxkef1Yz3VAXY1NH43bjoVM3DzK5uv6BH2P8ZkARxZqzicjVffSkgqlDsLyA0bBv4fvoGMAzLuNzd10QKb8bBmPd9Adc8BbDtiCNDcypzw-p8AyMWQm2FsArq15rc_Wwl4Va4i5zUPXkw0xo_nq1dBjAn9eBspV5hdhTJv5ATV_2HwAvODEavtqHv3329Al92P_GW6iG9F0aRdptyRwCenjptbaJM2FuuuFYAd2ym7RF6mZZ-TeBDHBy3JsrjBiHgL_vARF1vAiqBEP2xvKzZ6YlFXbV0lK7NYEoImk_riIt0Hx3PWwbbXrF81jcXxzExbcv-Rljnlc1Hf3UJiZfl185x6cnCKMcaRIQstrevNWggGB-_CZPR4HchKJXwAZmKn_s4x6yx6XI5JgkLNAsM79PqiItLeCQDhoJ5Ysm82h-tZI5rLbvQh7TtGXAC6aCa4tSsjOn0qH4UMONf_9gDmp4nwJfA2GrvBjAWlgVQcechBzsClCtMZiSNuvPU3d4W2jVE1lrvL-zYzlFYTEW_zDDmd7Ld3XV66L-uQNd7JAJlR5d8YTrjfPP1nodZXsYU2l0HjfrKXk30ConXN1ZMN2W3dfa3k0xwV3mHBzJTxBvkKJjaXKiQrrscDIUEv3eYoTfXw2rAV98XSUOwpdYkaUkCXlo-wa6qU4MIwxrdgry_QUO_bejHMlb08V7t8B_26TM88i0Grm7WQDyAfWO9B3AbhWkvGz0J_ojcFcWahbHT8SkM4qpCBC0KdFD_hD65gUFF3bss7hPVdDVZ041xBh17fA47D3F1pMudaWegHJsqsgGk537tTJUqrJuIspWr0hUkezJtFg6asEOXzJftqStOPBlwzpMpnUSF0QZfn_HA0svyB6f3cJjo9BSVPmntYy42WCqYweq0VK_Df1fjr604HodFu7X1zwkgsxojuCBAqwIztMtOrM0icq7JAGpHBCzOcrxh0av4QuItbzWoCWaxjhAoJj6Ze4u9GEFTjQ63kvtV2v_VVIHunWIAnSTA76i9TOZMfrtgKWviSJJeJkeNRrjL6HfKMQEUeNHCRyuR-XXJbqTXLCLA6yv4WE2XdnKwOxfec4wu9YuKiTUPeiJLHORWQ679jDwkSakvsEOPVLls20sMoptf83NoFxBkWwDddVvy5F70Qv_Xko6KugK2aAtCzrrGBcWjlxWpXuDtc2XxJS5uNn7U4zXfyC1moA1K0Xe-mis_qTsMWeBP1VZ3XdlT9ImD4_5NvBJd0t5tloJGtXX97f-fGLQwf0rJy5BMy9pNaN6jMcRC-yh3e9yYExaHPyN_CHi_6BwFZnW0tfsnBB72-l_7uybWM-lvRUWtQL8iVMaZ5v5F_utu2LBT0Yw0IhI0qFqL_5yJOcpCcS87ppsYQjCl5RiqLwsyPzLEorVBxrCChh2VIbplZcTY4hBvVYBjqwBDJQu06vXO3thp46-a0DxvaZLgVXfXq3ypV0AulL5j2wv24_Na_33BvBgglWKZWqwjnuoveokFL3XyLrwL_rfIb7pjz_6hbyTMo6ZobXZp5Lqq7UX3hT5_bTc35-WCAEY6TjltxGeJFZiejArgs9eKaTm19o4fE5YRyNrzAsf9CVcVdcyxQ62b0bmosFqwR4wuja3NrjalFoQi5L-Do2zf382tyVQW8Ur9BcNVc1D2Ai8zJCTBb0YlQVDQMUziBspq3s27QgXOIxHznaGycnsb64QcJ77h63rAULWvGBNUNWy5v0ESlAiGjQKmcOkDumxPVm_uqIstH45-EfUcDDkdmLhfvVJ8BTQk3hYCe5zJxtCbWrXBOed1xTN5epNNDtfSZv7WqQdDHM4yC_qZTKi-q3lWzgRrqkzWwZLmDQ6SzW_CwLLq1LoETFhe5VaKrwWkcAd1BWNl48pkQHp53Lg1w0yKzVpdL2dBVyDzaW9ZkhxMEZ4aThBsAnglQg1eNARMY_gDZDzHcKOs0R8ejerEJtgo__YvukTtQ9JwMTeRFfeGSDYTec5bqphetH4vQU5tw2LoURXQLGX-jyyHBGicoJREX-9GZ9uFE3onuB_ctQlXVsnxSmZbBHFQpdYBZTWjNVW_RfAppw.N1XcQqGLx4XNMiernX_uYw"
}


#chatbot.refresh_headers()
async def handle_response(message) -> str:
    prompt = message
    global Global_prompt
    #chatbot.refresh_session()
    #response = await chatbot.get_chat_response(prompt, output="text")
    data = {'prompt': Global_prompt + prompt,'token':'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'}
    response = requests.post('http://tolotra7.pythonanywhere.com/envoyerMessage/', data=json.dumps(data))
    print(response.json())
    responseMessage = response.json()["lastAnswer"]
    Global_prompt = response.json()["prompt"]
    return responseMessage


#chatbot = Chatbot(config, conversation_id=None)
